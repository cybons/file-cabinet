<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ­ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - ãƒ¢ãƒƒã‚¯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
        }
        
        .app {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header h1 {
            color: #333;
            font-size: 24px;
        }
        
        .mode-switch {
            display: flex;
            gap: 10px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #0066cc;
            color: white;
        }
        
        .btn-primary:hover {
            background: #0052a3;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-small {
            padding: 5px 15px;
            font-size: 12px;
        }
        
        .nav-tabs {
            background: white;
            padding: 0 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            gap: 5px;
        }
        
        .nav-tab {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 15px;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .nav-tab:hover {
            color: #0066cc;
        }
        
        .nav-tab.active {
            color: #0066cc;
            border-bottom-color: #0066cc;
            font-weight: 600;
        }
        
        .content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        thead {
            background: #f8f9fa;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            font-weight: 600;
            color: #333;
        }
        
        tbody tr:hover {
            background: #f8f9fa;
        }
        
        /* ç·¨é›†å¯èƒ½ãªã‚»ãƒ« */
        .editable-cell {
            cursor: text;
            min-width: 80px;
            padding: 8px 12px !important;
            background: #fffef7;
            border: 1px solid #e0e0e0;
            transition: all 0.2s;
        }
        
        .editable-cell:hover {
            background: #fff9e6;
            border-color: #ffc107;
        }
        
        .editable-cell:focus {
            outline: none;
            background: white;
            border-color: #0066cc;
            box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.1);
        }
        
        /* 2æ®µè¡¨ç¤ºã‚»ãƒ« */
        .two-tier-cell {
            padding: 0 !important;
        }
        
        .tier-top {
            background: #f0f0f0;
            padding: 6px 10px;
            border-bottom: 1px solid #d0d0d0;
            font-size: 12px;
            color: #666;
        }
        
        .tier-top strong {
            color: #333;
        }
        
        .tier-bottom {
            background: #fffef7;
            padding: 6px 10px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* å˜ä½å·®ç•°ãƒã‚¤ãƒ©ã‚¤ãƒˆ */
        .unit-difference .tier-top {
            background: #fff3cd;
            border-left: 3px solid #ff9800;
        }
        
        .unit-difference .tier-bottom {
            background: #fff8e1;
        }
        
        .unit-difference .tier-top strong {
            color: #e65100;
        }
        
        .tier-bottom-editable {
            min-width: 60px;
            padding: 4px 8px;
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 3px;
            cursor: text;
            transition: all 0.2s;
        }
        
        .tier-bottom-editable:hover {
            background: #fff9e6;
            border-color: #ffc107;
        }
        
        .tier-bottom-editable:focus {
            outline: none;
            background: white;
            border-color: #0066cc;
            box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.1);
        }
        
        .tier-bottom-unit {
            font-size: 12px;
            color: #666;
        }
        
        /* æŠ˜ã‚ŠãŸãŸã¿å¯èƒ½ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .collapsible-section {
            margin-top: 30px;
        }
        
        .collapsible-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            padding: 15px 20px;
            background: #f8f9fa;
            border-radius: 8px;
            transition: all 0.3s;
            user-select: none;
        }
        
        .collapsible-header:hover {
            background: #e9ecef;
        }
        
        .collapsible-header h3 {
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .collapsible-toggle {
            font-size: 20px;
            transition: transform 0.3s;
        }
        
        .collapsible-toggle.collapsed {
            transform: rotate(-90deg);
        }
        
        .collapsible-content {
            max-height: 2000px;
            overflow: hidden;
            transition: max-height 0.3s ease-out, opacity 0.3s;
            opacity: 1;
        }
        
        .collapsible-content.collapsed {
            max-height: 0;
            opacity: 0;
        }
        
        .sap-register-btn {
            margin-top: 15px;
            display: flex;
            justify-content: flex-end;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-success {
            background: #d4edda;
            color: #155724;
        }
        
        .badge-warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .rpa-panel {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 20px;
            border-radius: 4px;
            margin-top: 20px;
        }
        
        .rpa-panel h3 {
            margin-bottom: 15px;
            color: #333;
        }
        
        .rpa-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            color: #0c5460;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #0066cc;
        }
        
        .stat-card h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .stat-card .value {
            font-size: 32px;
            font-weight: 700;
            color: #333;
        }
        
        .hidden {
            display: none;
        }
        
        /* ã‚¢ãƒ©ãƒ¼ãƒˆã‚µãƒãƒªãƒ¼ */
        .alert-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .alert-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .alert-danger-card {
            border-left: 4px solid #dc3545;
        }
        
        .alert-warning-card {
            border-left: 4px solid #ffc107;
        }
        
        .alert-info-card {
            border-left: 4px solid #17a2b8;
        }
        
        .alert-card-icon {
            font-size: 36px;
        }
        
        .alert-card-content {
            flex: 1;
        }
        
        .alert-card-number {
            font-size: 32px;
            font-weight: 700;
            color: #333;
            line-height: 1;
        }
        
        .alert-card-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        
        /* ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— */
        .drag-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .drag-column {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        
        .drag-column h3 {
            margin-bottom: 20px;
            color: #333;
            font-size: 18px;
        }
        
        .card-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .order-card, .lot-card {
            background: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: move;
            transition: all 0.3s;
        }
        
        .order-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .order-card.dragging {
            opacity: 0.5;
            transform: rotate(3deg);
        }
        
        .lot-card {
            cursor: default;
            border: 2px solid transparent;
        }
        
        .lot-card.expiry-warning {
            border-left: 4px solid #dc3545;
        }
        
        .lot-card.drag-over {
            border: 2px dashed #0066cc;
            background: #e3f2fd;
            transform: scale(1.02);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .card-title {
            font-weight: 600;
            color: #333;
            font-size: 16px;
        }
        
        .card-body {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .card-info {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }
        
        .info-label {
            color: #666;
            font-weight: 500;
        }
        
        .info-value {
            color: #333;
            font-weight: 600;
        }
        
        .stock-value {
            color: #28a745;
        }
        
        .card-drag-hint {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ddd;
            text-align: center;
            color: #999;
            font-size: 13px;
        }
        
        .card-drop-hint {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px dashed #ddd;
            text-align: center;
            color: #0066cc;
            font-size: 13px;
            font-weight: 600;
        }
        
        /* ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥ */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10001;
            min-width: 300px;
            animation: slideIn 0.3s ease-out;
            transition: opacity 0.3s ease-out, transform 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .toast-success {
            border-left: 4px solid #28a745;
        }
        
        .toast-error {
            border-left: 4px solid #dc3545;
        }
        
        .toast-warning {
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>ãƒ­ãƒƒãƒˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <div class="mode-switch">
                <button class="btn btn-primary" id="normalModeBtn">é€šå¸¸ãƒ¢ãƒ¼ãƒ‰</button>
                <button class="btn btn-secondary" id="rpaModeBtn">RPAå®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰</button>
            </div>
        </div>
        
        <!-- é€šå¸¸ãƒ¢ãƒ¼ãƒ‰ -->
        <div id="normalMode">
            <div class="stats-grid">
                <div class="stat-card">
                    <h3>ç·åœ¨åº«æ•°</h3>
                    <div class="value" id="totalStock">700</div>
                </div>
                <div class="stat-card" style="border-left-color: #28a745;">
                    <h3>ç·å—æ³¨æ•°</h3>
                    <div class="value" id="totalOrders">6</div>
                </div>
                <div class="stat-card" style="border-left-color: #dc3545;">
                    <h3>æœªå¼•å½“å—æ³¨</h3>
                    <div class="value" id="unallocatedOrders">5</div>
                </div>
            </div>
            
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="receipt">ææ–™å…¥è·</button>
                <button class="nav-tab" data-tab="order">å—æ³¨ç®¡ç†</button>
                <button class="nav-tab" data-tab="dragAllocation">ãƒ‰ãƒ©ãƒƒã‚°å¼•å½“</button>
                <button class="nav-tab" data-tab="allocation">ãƒ­ãƒƒãƒˆå¼•å½“</button>
                <button class="nav-tab" data-tab="inventory">åœ¨åº«ä¸€è¦§</button>
                <button class="nav-tab" data-tab="alert">æœŸé™ã‚¢ãƒ©ãƒ¼ãƒˆ</button>
            </div>
            
            <div class="content">
                <!-- ææ–™å…¥è·ã‚¿ãƒ– -->
                <div id="receiptTab" class="tab-content">
                    <h2>ææ–™å…¥è·ç™»éŒ²</h2>
                    <form id="receiptForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>ææ–™</label>
                                <select id="materialSelect" required>
                                    <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                    <option value="1">EXT-A123 - ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</option>
                                    <option value="2">EXT-B456 - ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</option>
                                    <option value="3">EXT-C789 - ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>ãƒ­ãƒƒãƒˆç•ªå·</label>
                                <input type="text" id="lotNumber" placeholder="L20251029-001" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>å…¥è·æ•°é‡</label>
                                <input type="number" id="quantity" required>
                            </div>
                            <div class="form-group">
                                <label>å…¥è·æ—¥</label>
                                <input type="date" id="receiptDate" required>
                            </div>
                            <div class="form-group">
                                <label>æœ‰åŠ¹æœŸé™</label>
                                <input type="date" id="expiryDate" required>
                            </div>
                        </div>
                        <div class="action-buttons">
                            <button type="submit" class="btn btn-primary">ç™»éŒ²</button>
                        </div>
                    </form>
                </div>
                
                <!-- å—æ³¨ç®¡ç†ã‚¿ãƒ– -->
                <div id="orderTab" class="tab-content hidden">
                    <h2>å—æ³¨ä¸€è¦§</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>å¾—æ„å…ˆ</th>
                                    <th>ææ–™å</th>
                                    <th>å—æ³¨æ•°é‡</th>
                                    <th>ç´æœŸ</th>
                                    <th>æœ‰åŠ¹æœŸé™</th>
                                    <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                    <th>å¼•å½“æ•°é‡</th>
                                    <th>æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody id="orderTableBody">
                                <tr>
                                    <td>L20251028-001</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</td>
                                    <td>100</td>
                                    <td>2025-11-05</td>
                                    <td>2026-04-28</td>
                                    <td><span class="badge badge-warning">æœªå¼•å½“</span></td>
                                    <td><input type="number" id="allocQty1" min="0" max="100" placeholder="0" style="width: 80px; padding: 5px;"></td>
                                    <td><button class="btn btn-primary btn-small" onclick="allocateOrder(1, 'L20251028-001', 'ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰', 100)">å¼•å½“</button></td>
                                </tr>
                                <tr>
                                    <td>L20251015-001</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</td>
                                    <td>80</td>
                                    <td>2025-11-05</td>
                                    <td><span style="color: #dc3545; font-weight: 600;">2025-11-25</span></td>
                                    <td><span class="badge badge-warning">æœªå¼•å½“</span></td>
                                    <td><input type="number" id="allocQty2" min="0" max="80" placeholder="0" style="width: 80px; padding: 5px;"></td>
                                    <td><button class="btn btn-primary btn-small" onclick="allocateOrder(2, 'L20251015-001', 'ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰', 80)">å¼•å½“</button></td>
                                </tr>
                                <tr>
                                    <td>L20251027-002</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>120</td>
                                    <td>2025-11-08</td>
                                    <td>2026-10-27</td>
                                    <td><span class="badge badge-warning">æœªå¼•å½“</span></td>
                                    <td><input type="number" id="allocQty3" min="0" max="120" placeholder="0" style="width: 80px; padding: 5px;"></td>
                                    <td><button class="btn btn-primary btn-small" onclick="allocateOrder(3, 'L20251027-002', 'ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼', 120)">å¼•å½“</button></td>
                                </tr>
                                <tr>
                                    <td>L20251020-003</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>60</td>
                                    <td>2025-11-10</td>
                                    <td>2026-05-20</td>
                                    <td><span class="badge badge-warning">æœªå¼•å½“</span></td>
                                    <td><input type="number" id="allocQty4" min="0" max="60" placeholder="0" style="width: 80px; padding: 5px;"></td>
                                    <td><button class="btn btn-primary btn-small" onclick="allocateOrder(4, 'L20251020-003', 'ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼', 60)">å¼•å½“</button></td>
                                </tr>
                                <tr>
                                    <td>L20251026-004</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>50</td>
                                    <td>2025-11-12</td>
                                    <td>2026-04-26</td>
                                    <td><span class="badge badge-warning">æœªå¼•å½“</span></td>
                                    <td><input type="number" id="allocQty5" min="0" max="50" placeholder="0" style="width: 80px; padding: 5px;"></td>
                                    <td><button class="btn btn-primary btn-small" onclick="allocateOrder(5, 'L20251026-004', 'ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼', 50)">å¼•å½“</button></td>
                                </tr>
                                <tr style="opacity: 0.6;">
                                    <td>L20251027-005</td>
                                    <td>ãƒ‡ãƒ³ã‚½ãƒ¼05</td>
                                    <td>ã‚¿ã‚¤ãƒ¤</td>
                                    <td>40</td>
                                    <td>2025-11-03</td>
                                    <td>2025-12-15</td>
                                    <td><span class="badge badge-success">å¼•å½“æ¸ˆ</span></td>
                                    <td>-</td>
                                    <td>-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- ãƒ‰ãƒ©ãƒƒã‚°å¼•å½“ã‚¿ãƒ– -->
                <div id="dragAllocationTab" class="tab-content hidden">
                    <h2>ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¼•å½“</h2>
                    <p style="color: #666; margin-bottom: 20px;">å—æ³¨ã‚«ãƒ¼ãƒ‰ã‚’ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã«ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å¼•å½“å‡¦ç†ã‚’è¡Œã„ã¾ã™</p>
                    
                    <div class="drag-container">
                        <div class="drag-column">
                            <h3>ğŸ“‹ æœªå¼•å½“å—æ³¨</h3>
                            <div class="card-list" id="orderCards">
                                <div class="order-card" draggable="true" data-order-id="1" data-material="ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰" data-quantity="100">
                                    <div class="card-header">
                                        <span class="card-title">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</span>
                                        <span class="badge badge-warning">æœªå¼•å½“</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">æ•°é‡:</span>
                                            <span class="info-value">100å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">ç´æœŸ:</span>
                                            <span class="info-value">2025-11-05</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">å¾—æ„å…ˆ:</span>
                                            <span class="info-value">ãƒ‡ãƒ³ã‚½ãƒ¼05</span>
                                        </div>
                                    </div>
                                    <div class="card-drag-hint">ğŸ–±ï¸ ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å¼•å½“</div>
                                </div>
                                
                                <div class="order-card" draggable="true" data-order-id="2" data-material="ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰" data-quantity="80">
                                    <div class="card-header">
                                        <span class="card-title">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</span>
                                        <span class="badge badge-warning">æœªå¼•å½“</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">æ•°é‡:</span>
                                            <span class="info-value">80å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">ç´æœŸ:</span>
                                            <span class="info-value">2025-11-05</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">å¾—æ„å…ˆ:</span>
                                            <span class="info-value">ãƒ‡ãƒ³ã‚½ãƒ¼05</span>
                                        </div>
                                    </div>
                                    <div class="card-drag-hint">ğŸ–±ï¸ ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å¼•å½“</div>
                                </div>
                                
                                <div class="order-card" draggable="true" data-order-id="3" data-material="ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼" data-quantity="120">
                                    <div class="card-header">
                                        <span class="card-title">ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</span>
                                        <span class="badge badge-warning">æœªå¼•å½“</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">æ•°é‡:</span>
                                            <span class="info-value">120å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">ç´æœŸ:</span>
                                            <span class="info-value">2025-11-08</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">å¾—æ„å…ˆ:</span>
                                            <span class="info-value">ãƒ‡ãƒ³ã‚½ãƒ¼05</span>
                                        </div>
                                    </div>
                                    <div class="card-drag-hint">ğŸ–±ï¸ ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦å¼•å½“</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="drag-column">
                            <h3>ğŸ“¦ åˆ©ç”¨å¯èƒ½ãƒ­ãƒƒãƒˆ</h3>
                            <div class="card-list" id="lotCards">
                                <div class="lot-card drop-zone" data-lot-number="L20251028-001" data-material="ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰" data-stock="500" data-expiry="2026-04-28">
                                    <div class="card-header">
                                        <span class="card-title">L20251028-001</span>
                                        <span class="badge badge-success">æ­£å¸¸</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">ææ–™:</span>
                                            <span class="info-value">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">åœ¨åº«:</span>
                                            <span class="info-value stock-value">500å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">æœŸé™:</span>
                                            <span class="info-value">2026-04-28</span>
                                        </div>
                                    </div>
                                    <div class="card-drop-hint hidden">â†“ ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—</div>
                                </div>
                                
                                <div class="lot-card drop-zone expiry-warning" data-lot-number="L20251015-001" data-material="ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰" data-stock="80" data-expiry="2025-11-25">
                                    <div class="card-header">
                                        <span class="card-title">L20251015-001</span>
                                        <span class="badge badge-danger" style="background: #f8d7da; color: #721c24;">æœŸé™é–“è¿‘</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">ææ–™:</span>
                                            <span class="info-value">ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">åœ¨åº«:</span>
                                            <span class="info-value stock-value">80å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">æœŸé™:</span>
                                            <span class="info-value" style="color: #dc3545; font-weight: 600;">2025-11-25 âš ï¸</span>
                                        </div>
                                    </div>
                                    <div class="card-drop-hint hidden">â†“ ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—</div>
                                </div>
                                
                                <div class="lot-card drop-zone" data-lot-number="L20251027-002" data-material="ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼" data-stock="220" data-expiry="2026-10-27">
                                    <div class="card-header">
                                        <span class="card-title">L20251027-002</span>
                                        <span class="badge badge-success">æ­£å¸¸</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">ææ–™:</span>
                                            <span class="info-value">ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">åœ¨åº«:</span>
                                            <span class="info-value stock-value">220å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">æœŸé™:</span>
                                            <span class="info-value">2026-10-27</span>
                                        </div>
                                    </div>
                                    <div class="card-drop-hint hidden">â†“ ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—</div>
                                </div>
                                
                                <div class="lot-card drop-zone" data-lot-number="L20251020-003" data-material="ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼" data-stock="150" data-expiry="2026-05-20">
                                    <div class="card-header">
                                        <span class="card-title">L20251020-003</span>
                                        <span class="badge badge-success">æ­£å¸¸</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="card-info">
                                            <span class="info-label">ææ–™:</span>
                                            <span class="info-value">ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">åœ¨åº«:</span>
                                            <span class="info-value stock-value">150å€‹</span>
                                        </div>
                                        <div class="card-info">
                                            <span class="info-label">æœŸé™:</span>
                                            <span class="info-value">2026-05-20</span>
                                        </div>
                                    </div>
                                    <div class="card-drop-hint hidden">â†“ ã“ã“ã«ãƒ‰ãƒ­ãƒƒãƒ—</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ãƒ­ãƒƒãƒˆå¼•å½“ã‚¿ãƒ– -->
                <div id="allocationTab" class="tab-content hidden">
                    <h2>å¼•å½“å±¥æ­´</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>å—æ³¨ç•ªå·</th>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>ææ–™å</th>
                                    <th>æ•°é‡</th>
                                    <th>å¼•å½“æ—¥</th>
                                </tr>
                            </thead>
                            <tbody id="allocationTableBody">
                                <tr>
                                    <td>ORD-2025-002</td>
                                    <td>L20251027-002</td>
                                    <td>ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>80</td>
                                    <td>2025-10-28</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- åœ¨åº«ä¸€è¦§ã‚¿ãƒ– -->
                <div id="inventoryTab" class="tab-content hidden">
                    <h2>ãƒ­ãƒƒãƒˆåœ¨åº«ä¸€è¦§</h2>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>ææ–™å</th>
                                    <th>å…¥è·æ—¥</th>
                                    <th>å…¥è·æ•°é‡</th>
                                    <th>åœ¨åº«æ•°é‡</th>
                                    <th>æœ‰åŠ¹æœŸé™</th>
                                    <th>çŠ¶æ…‹</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <tr>
                                    <td>L20251028-001</td>
                                    <td>ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ‘ãƒƒãƒ‰</td>
                                    <td>2025-10-28</td>
                                    <td>500</td>
                                    <td>500</td>
                                    <td>2026-04-28</td>
                                    <td><span class="badge badge-success">æ­£å¸¸</span></td>
                                </tr>
                                <tr>
                                    <td>L20251027-002</td>
                                    <td>ã‚ªã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>2025-10-27</td>
                                    <td>300</td>
                                    <td>220</td>
                                    <td>2026-10-27</td>
                                    <td><span class="badge badge-success">æ­£å¸¸</span></td>
                                </tr>
                                <tr>
                                    <td>L20251026-003</td>
                                    <td>ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>2025-10-26</td>
                                    <td>200</td>
                                    <td>50</td>
                                    <td>2026-04-26</td>
                                    <td><span class="badge badge-warning">è­¦å‘Š</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- æœŸé™ã‚¢ãƒ©ãƒ¼ãƒˆã‚¿ãƒ– -->
                <div id="alertTab" class="tab-content hidden">
                    <h2>æœ‰åŠ¹æœŸé™ã‚¢ãƒ©ãƒ¼ãƒˆ</h2>
                    
                    <div class="alert-summary">
                        <div class="alert-card alert-danger-card">
                            <div class="alert-card-icon">âš ï¸</div>
                            <div class="alert-card-content">
                                <div class="alert-card-number">2</div>
                                <div class="alert-card-label">æœŸé™åˆ‡ã‚Œé–“è¿‘ (30æ—¥ä»¥å†…)</div>
                            </div>
                        </div>
                        <div class="alert-card alert-warning-card">
                            <div class="alert-card-icon">â°</div>
                            <div class="alert-card-content">
                                <div class="alert-card-number">3</div>
                                <div class="alert-card-label">æ³¨æ„ (60æ—¥ä»¥å†…)</div>
                            </div>
                        </div>
                        <div class="alert-card alert-info-card">
                            <div class="alert-card-icon">ğŸ“¦</div>
                            <div class="alert-card-content">
                                <div class="alert-card-number">1</div>
                                <div class="alert-card-label">åœ¨åº«åƒ…å°‘ (50å€‹ä»¥ä¸‹)</div>
                            </div>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px; margin-bottom: 15px;">âš ï¸ æœŸé™åˆ‡ã‚Œé–“è¿‘ (30æ—¥ä»¥å†…)</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>ææ–™å</th>
                                    <th>åœ¨åº«æ•°é‡</th>
                                    <th>æœ‰åŠ¹æœŸé™</th>
                                    <th>æ®‹æ—¥æ•°</th>
                                    <th>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fff5f5;">
                                    <td>L20251015-004</td>
                                    <td>ãƒ¯ã‚¤ãƒ‘ãƒ¼ãƒ–ãƒ¬ãƒ¼ãƒ‰</td>
                                    <td>80</td>
                                    <td>2025-11-20</td>
                                    <td><span class="badge badge-danger" style="background: #f8d7da; color: #721c24; font-weight: bold;">22æ—¥</span></td>
                                    <td>æ—©æœŸå‡ºè·æ¨å¥¨</td>
                                </tr>
                                <tr style="background: #fff5f5;">
                                    <td>L20251010-005</td>
                                    <td>ã‚¨ãƒ³ã‚¸ãƒ³ã‚ªã‚¤ãƒ«</td>
                                    <td>120</td>
                                    <td>2025-11-25</td>
                                    <td><span class="badge badge-danger" style="background: #f8d7da; color: #721c24; font-weight: bold;">27æ—¥</span></td>
                                    <td>æ—©æœŸå‡ºè·æ¨å¥¨</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h3 style="margin-top: 30px; margin-bottom: 15px;">â° æ³¨æ„ (60æ—¥ä»¥å†…)</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>ææ–™å</th>
                                    <th>åœ¨åº«æ•°é‡</th>
                                    <th>æœ‰åŠ¹æœŸé™</th>
                                    <th>æ®‹æ—¥æ•°</th>
                                    <th>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #fffbf0;">
                                    <td>L20251020-006</td>
                                    <td>ã‚¿ã‚¤ãƒ¤</td>
                                    <td>40</td>
                                    <td>2025-12-15</td>
                                    <td><span class="badge badge-warning" style="background: #fff3cd; color: #856404;">47æ—¥</span></td>
                                    <td>å„ªå…ˆå¼•å½“</td>
                                </tr>
                                <tr style="background: #fffbf0;">
                                    <td>L20251018-007</td>
                                    <td>ãƒãƒƒãƒ†ãƒªãƒ¼</td>
                                    <td>25</td>
                                    <td>2025-12-20</td>
                                    <td><span class="badge badge-warning" style="background: #fff3cd; color: #856404;">52æ—¥</span></td>
                                    <td>å„ªå…ˆå¼•å½“</td>
                                </tr>
                                <tr style="background: #fffbf0;">
                                    <td>L20251026-003</td>
                                    <td>ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td>50</td>
                                    <td>2025-12-28</td>
                                    <td><span class="badge badge-warning" style="background: #fff3cd; color: #856404;">60æ—¥</span></td>
                                    <td>å„ªå…ˆå¼•å½“</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <h3 style="margin-top: 30px; margin-bottom: 15px;">ğŸ“¦ åœ¨åº«åƒ…å°‘ã‚¢ãƒ©ãƒ¼ãƒˆ</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                    <th>ææ–™å</th>
                                    <th>åœ¨åº«æ•°é‡</th>
                                    <th>æœ‰åŠ¹æœŸé™</th>
                                    <th>æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="background: #f0f8ff;">
                                    <td>L20251026-003</td>
                                    <td>ã‚¨ã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼</td>
                                    <td><span class="badge badge-warning" style="background: #fff3cd; color: #856404; font-weight: bold;">50å€‹</span></td>
                                    <td>2026-04-26</td>
                                    <td>ç™ºæ³¨æ¤œè¨</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- RPAãƒ¢ãƒ¼ãƒ‰ -->
        <div id="rpaMode" class="hidden">
            <div class="content">
                <div class="alert alert-info">
                    <strong>RPAå®Ÿè¡Œãƒ¢ãƒ¼ãƒ‰</strong> - è‡ªå‹•å‡¦ç†ã‚’å®Ÿè¡Œã§ãã¾ã™(1æ—¥2ã€œ3å›)
                </div>
                
                <div class="rpa-panel">
                    <h3>ğŸ¤– è‡ªå‹•å‡¦ç†ãƒ¡ãƒ‹ãƒ¥ãƒ¼</h3>
                    <div class="rpa-actions">
                        <button class="btn btn-success" onclick="runRPA('ocr')">ğŸ“„ AI-OCR: ç´å“æ›¸èª­å–</button>
                        <button class="btn btn-success" onclick="runRPA('sap')">ğŸ“ SAPå—æ³¨è‡ªå‹•ç™»éŒ²</button>
                        <button class="btn btn-success" onclick="runRPA('shipping')">ğŸšš å‡ºè·æŒ‡ç¤ºç”Ÿæˆ</button>
                        <button class="btn btn-success" onclick="runRPA('report')">ğŸ“Š åœ¨åº«ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ</button>
                    </div>
                </div>
                
                <div class="collapsible-section">
                    <div class="collapsible-header" onclick="toggleCollapse('shippingData')">
                        <h3>
                            <span>ğŸ“¦ å‡ºè·ãƒ‡ãƒ¼ã‚¿</span>
                            <span style="font-size: 14px; color: #666; font-weight: normal;" id="shippingDataCount">(3ä»¶)</span>
                        </h3>
                        <span class="collapsible-toggle" id="shippingDataToggle">â–¼</span>
                    </div>
                    <div class="collapsible-content" id="shippingDataContent">
                        <div class="table-container">
                            <table id="shippingDataTable">
                                <thead>
                                    <tr>
                                        <th>ãƒ­ãƒƒãƒˆç•ªå·</th>
                                        <th>å…ˆæ–¹å“ç•ª</th>
                                        <th>ãƒ¡ãƒ¼ã‚«ãƒ¼å“ç•ª</th>
                                        <th style="min-width: 150px;">æ•°é‡</th>
                                        <th>ä»•å…¥ã‚Œå…ˆ</th>
                                        <th>å‡ºè·å€‰åº«ã‚³ãƒ¼ãƒ‰</th>
                                        <th>å‡ºè·å€‰åº«å</th>
                                        <th>æ¬¡åŒºã‚³ãƒ¼ãƒ‰</th>
                                        <th>ç´å…¥å…ˆã‚³ãƒ¼ãƒ‰</th>
                                        <th>ç´å…¥å…ˆåç§°</th>
                                        <th>å‡ºè·è¡¨ãƒ†ã‚­ã‚¹ãƒˆ</th>
                                    </tr>
                                </thead>
                                <tbody id="shippingDataTableBody">
                                    <!-- ãƒ‡ãƒ¼ã‚¿ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
                                </tbody>
                            </table>
                        </div>
                        <div class="sap-register-btn">
                            <button class="btn btn-success" onclick="registerToSAP()">ğŸ“ SAPç™»éŒ²</button>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>ğŸ“‹ SAPç™»éŒ²ãƒ­ã‚°</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>é€ä¿¡æ—¥æ™‚</th>
                                    <th>é€ä¿¡ä»¶æ•°</th>
                                    <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                    <th>å‚™è€ƒ</th>
                                </tr>
                            </thead>
                            <tbody id="sapLogTableBody">
                                <tr>
                                    <td colspan="4" style="text-align: center; color: #999;">ã¾ã é€ä¿¡å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3>å®Ÿè¡Œå±¥æ­´</h3>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>å®Ÿè¡Œæ—¥æ™‚</th>
                                    <th>å‡¦ç†å</th>
                                    <th>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                                    <th>å‡¦ç†ä»¶æ•°</th>
                                </tr>
                            </thead>
                            <tbody id="rpaHistoryBody">
                                <tr>
                                    <td>2025-10-29 10:30</td>
                                    <td>SAPå—æ³¨è‡ªå‹•ç™»éŒ²</td>
                                    <td><span class="badge badge-success">å®Œäº†</span></td>
                                    <td>15ä»¶</td>
                                </tr>
                                <tr>
                                    <td>2025-10-29 09:15</td>
                                    <td>AI-OCR: ç´å“æ›¸èª­å–</td>
                                    <td><span class="badge badge-success">å®Œäº†</span></td>
                                    <td>8ä»¶</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // ãƒˆãƒ¼ã‚¹ãƒˆé€šçŸ¥
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast toast-${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(400px)';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
        
        // ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
        const normalModeBtn = document.getElementById('normalModeBtn');
        const rpaModeBtn = document.getElementById('rpaModeBtn');
        const normalMode = document.getElementById('normalMode');
        const rpaMode = document.getElementById('rpaMode');
        
        normalModeBtn.addEventListener('click', () => {
            normalMode.classList.remove('hidden');
            rpaMode.classList.add('hidden');
            normalModeBtn.classList.remove('btn-secondary');
            normalModeBtn.classList.add('btn-primary');
            rpaModeBtn.classList.remove('btn-success');
            rpaModeBtn.classList.add('btn-secondary');
        });
        
        rpaModeBtn.addEventListener('click', () => {
            normalMode.classList.add('hidden');
            rpaMode.classList.remove('hidden');
            normalModeBtn.classList.remove('btn-primary');
            normalModeBtn.classList.add('btn-secondary');
            rpaModeBtn.classList.remove('btn-secondary');
            rpaModeBtn.classList.add('btn-success');
        });
        
        // ã‚¿ãƒ–åˆ‡æ›¿
        const navTabs = document.querySelectorAll('.nav-tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        navTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // ã™ã¹ã¦ã®ã‚¿ãƒ–ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‹ã‚‰ active ã‚’å‰Šé™¤
                navTabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.add('hidden'));
                
                // ã‚¯ãƒªãƒƒã‚¯ã•ã‚ŒãŸã‚¿ãƒ–ã‚’ active ã«
                tab.classList.add('active');
                const tabName = tab.getAttribute('data-tab');
                document.getElementById(tabName + 'Tab').classList.remove('hidden');
            });
        });
        
        // å…¥è·ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ 
        const receiptForm = document.getElementById('receiptForm');
        receiptForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const materialSelect = document.getElementById('materialSelect');
            const materialName = materialSelect.options[materialSelect.selectedIndex].text.split(' - ')[1];
            const lotNumber = document.getElementById('lotNumber').value;
            const quantity = document.getElementById('quantity').value;
            const receiptDate = document.getElementById('receiptDate').value;
            const expiryDate = document.getElementById('expiryDate').value;
            
            // ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ 
            const inventoryBody = document.getElementById('inventoryTableBody');
            const newRow = inventoryBody.insertRow(0);
            newRow.innerHTML = `
                <td>${lotNumber}</td>
                <td>${materialName}</td>
                <td>${receiptDate}</td>
                <td>${quantity}</td>
                <td>${quantity}</td>
                <td>${expiryDate}</td>
                <td><span class="badge badge-success">æ­£å¸¸</span></td>
            `;
            
            // çµ±è¨ˆæ›´æ–°
            const currentStock = parseInt(document.getElementById('totalStock').textContent, 10) || 0;
            document.getElementById('totalStock').textContent = currentStock + parseInt(quantity, 10);
            
            showToast('å…¥è·ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
            receiptForm.reset();
            
            // ä»Šæ—¥ã®æ—¥ä»˜ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('receiptDate').value = today;
        });
        
        // å¼•å½“å‡¦ç†
        function allocateOrder(rowId, lotNumber, materialName, orderQuantity) {
            const qtyInput = document.getElementById(`allocQty${rowId}`);
            const allocQty = parseInt(qtyInput.value, 10) || 0;
            
            if (allocQty <= 0) {
                showToast('å¼•å½“æ•°é‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'warning');
                return;
            }
            
            if (allocQty > orderQuantity) {
                showToast(`å¼•å½“æ•°é‡(${allocQty}å€‹)ãŒå—æ³¨æ•°é‡(${orderQuantity}å€‹)ã‚’è¶…ãˆã¦ã„ã¾ã™`, 'error');
                return;
            }
            
            // å¼•å½“å±¥æ­´ã«è¿½åŠ 
            const allocationBody = document.getElementById('allocationTableBody');
            const newRow = allocationBody.insertRow(0);
            const today = new Date().toISOString().split('T')[0];
            newRow.innerHTML = `
                <td>å—æ³¨-${Date.now().toString().slice(-6)}</td>
                <td>${lotNumber}</td>
                <td>${materialName}</td>
                <td>${allocQty}</td>
                <td>${today}</td>
            `;
            
            // åœ¨åº«æ›´æ–°
            const inventoryRows = document.querySelectorAll('#inventoryTableBody tr');
            inventoryRows.forEach(row => {
                const rowLotNumber = row.cells[0].textContent;
                if (rowLotNumber === lotNumber) {
                    const remainingCell = row.cells[4];
                    const currentRemaining = parseInt(remainingCell.textContent, 10) || 0;
                    remainingCell.textContent = currentRemaining - allocQty;
                }
            });
            
            // å—æ³¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
            const orderRow = document.querySelector(`#orderTableBody tr:nth-child(${rowId})`);
            const isFullyAllocated = allocQty === orderQuantity;
            
            if (isFullyAllocated) {
                // å…¨é‡å¼•å½“
                orderRow.querySelector('td:nth-child(7)').innerHTML = '<span class="badge badge-success">å¼•å½“æ¸ˆ</span>';
                orderRow.querySelector('td:nth-child(8)').textContent = '-';
                orderRow.querySelector('td:nth-child(9)').textContent = '-';
                
                // çµ±è¨ˆæ›´æ–°
                const unallocated = parseInt(document.getElementById('unallocatedOrders').textContent, 10) || 0;
                document.getElementById('unallocatedOrders').textContent = unallocated - 1;
            } else {
                // éƒ¨åˆ†å¼•å½“ - æ®‹é‡ã‚’è¡¨ç¤º
                const remainingQty = orderQuantity - allocQty;
                orderRow.querySelector('td:nth-child(7)').innerHTML = '<span class="badge badge-warning">éƒ¨åˆ†å¼•å½“</span>';
                orderRow.querySelector('td:nth-child(4)').innerHTML = 
                    `<span style="color: #dc3545; font-weight: 600;">${remainingQty}</span> <small style="color: #999;">(æ®‹)</small>`;
                
                // å…¥åŠ›æ¬„ã®maxã‚’æ›´æ–°
                qtyInput.max = remainingQty;
                qtyInput.placeholder = `0 / ${remainingQty}`;
            }
            
            // ç·åœ¨åº«æ•°æ›´æ–°
            const totalStock = parseInt(document.getElementById('totalStock').textContent, 10) || 0;
            document.getElementById('totalStock').textContent = totalStock - allocQty;
            
            // å…¥åŠ›æ¬„ã‚’ã‚¯ãƒªã‚¢
            qtyInput.value = '';
            
            showToast(`å¼•å½“å®Œäº†: ${allocQty}å€‹ã‚’å¼•ãå½“ã¦ã¾ã—ãŸ (ãƒ­ãƒƒãƒˆ: ${lotNumber})`, 'success');
        }
        
        // RPAå®Ÿè¡Œ
        function runRPA(type) {
            const typeNames = {
                'ocr': 'AI-OCR: ç´å“æ›¸èª­å–',
                'sap': 'SAPå—æ³¨è‡ªå‹•ç™»éŒ²',
                'shipping': 'å‡ºè·æŒ‡ç¤ºç”Ÿæˆ',
                'report': 'åœ¨åº«ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ'
            };
            
            showToast(`${typeNames[type]}ã‚’å®Ÿè¡Œã—ã¾ã™`, 'success');
            
            // å±¥æ­´ã«è¿½åŠ 
            const historyBody = document.getElementById('rpaHistoryBody');
            const newRow = historyBody.insertRow(0);
            const now = new Date();
            const datetime = `${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}-${String(now.getDate()).padStart(2,'0')} ${String(now.getHours()).padStart(2,'0')}:${String(now.getMinutes()).padStart(2,'0')}`;
            const count = Math.floor(Math.random() * 20) + 5;
            
            newRow.innerHTML = `
                <td>${datetime}</td>
                <td>${typeNames[type]}</td>
                <td><span class="badge badge-success">å®Œäº†</span></td>
                <td>${count}ä»¶</td>
            `;
        }
        
        // åˆæœŸåŒ–: ä»Šæ—¥ã®æ—¥ä»˜ã‚’ã‚»ãƒƒãƒˆ
        window.addEventListener('DOMContentLoaded', () => {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('receiptDate').value = today;
            
            // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã®åˆæœŸåŒ–
            initDragAndDrop();
        });
        
        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½
        let draggedOrderData = null;
        
        function initDragAndDrop() {
            const orderCards = document.querySelectorAll('.order-card');
            const lotCards = document.querySelectorAll('.lot-card');
            
            // å—æ³¨ã‚«ãƒ¼ãƒ‰ã®ãƒ‰ãƒ©ãƒƒã‚°ã‚¤ãƒ™ãƒ³ãƒˆ
            orderCards.forEach(card => {
                card.addEventListener('dragstart', (e) => {
                    card.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                    
                    // ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒ
                    draggedOrderData = {
                        orderId: card.dataset.orderId,
                        material: card.dataset.material,
                        quantity: parseInt(card.dataset.quantity, 10)
                    };
                    
                    e.dataTransfer.setData('text/plain', ''); // Firefoxå¯¾å¿œ
                });
                
                card.addEventListener('dragend', (e) => {
                    card.classList.remove('dragging');
                    draggedOrderData = null;
                });
            });
            
            // ãƒ­ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã®ãƒ‰ãƒ­ãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆ
            lotCards.forEach(card => {
                card.addEventListener('dragover', (e) => {
                    if (!draggedOrderData) return;
                    
                    const lotMaterial = card.dataset.material;
                    
                    // ææ–™ãŒä¸€è‡´ã™ã‚‹å ´åˆã®ã¿ãƒ‰ãƒ­ãƒƒãƒ—å¯èƒ½
                    if (draggedOrderData.material === lotMaterial) {
                        e.preventDefault();
                        card.classList.add('drag-over');
                        const hint = card.querySelector('.card-drop-hint');
                        if (hint) hint.classList.remove('hidden');
                    }
                });
                
                card.addEventListener('dragleave', (e) => {
                    card.classList.remove('drag-over');
                    const hint = card.querySelector('.card-drop-hint');
                    if (hint) hint.classList.add('hidden');
                });
                
                card.addEventListener('drop', (e) => {
                    e.preventDefault();
                    card.classList.remove('drag-over');
                    const hint = card.querySelector('.card-drop-hint');
                    if (hint) hint.classList.add('hidden');
                    
                    if (!draggedOrderData) return;
                    
                    const orderId = draggedOrderData.orderId;
                    const orderMaterial = draggedOrderData.material;
                    const orderQuantity = draggedOrderData.quantity;
                    
                    const lotNumber = card.dataset.lotNumber;
                    const lotMaterial = card.dataset.material;
                    const lotStock = parseInt(card.dataset.stock, 10) || 0;
                    
                    // ææ–™ãŒä¸€è‡´ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                    if (orderMaterial !== lotMaterial) {
                        showToast(`ææ–™ãŒä¸€è‡´ã—ã¾ã›ã‚“: ${orderMaterial} â‰  ${lotMaterial}`, 'error');
                        return;
                    }
                    
                    // åœ¨åº«ãŒè¶³ã‚Šã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                    if (orderQuantity > lotStock) {
                        showToast(`åœ¨åº«ä¸è¶³: ${orderQuantity}å€‹ > ${lotStock}å€‹`, 'error');
                        return;
                    }
                    
                    // å¼•å½“ç¢ºèª
                    const confirmed = confirm(`
ã€å¼•å½“ç¢ºèªã€‘
å—æ³¨: ${orderMaterial} ${orderQuantity}å€‹
ãƒ­ãƒƒãƒˆ: ${lotNumber}
åœ¨åº«: ${lotStock}å€‹

ã“ã®å—æ³¨ã‚’å¼•ãå½“ã¦ã¾ã™ã‹?`);
                    
                    if (confirmed) {
                        // å¼•å½“å‡¦ç†
                        executeDragAllocation(orderId, lotNumber, orderMaterial, orderQuantity, lotStock);
                        
                        // å—æ³¨ã‚«ãƒ¼ãƒ‰ã‚’å‰Šé™¤
                        const orderCard = document.querySelector(`.order-card[data-order-id="${orderId}"]`);
                        if (orderCard) {
                            orderCard.style.transition = 'all 0.3s';
                            orderCard.style.opacity = '0';
                            orderCard.style.transform = 'scale(0.8)';
                            setTimeout(() => orderCard.remove(), 300);
                        }
                        
                        // ãƒ­ãƒƒãƒˆåœ¨åº«ã‚’æ›´æ–°
                        const newStock = lotStock - orderQuantity;
                        card.dataset.stock = newStock;
                        const stockValue = card.querySelector('.stock-value');
                        if (stockValue) {
                            stockValue.textContent = `${newStock}å€‹`;
                            if (newStock < 50) {
                                stockValue.style.color = '#dc3545';
                            }
                        }
                    }
                });
            });
        }
        
        function executeDragAllocation(orderId, lotNumber, materialName, quantity, originalStock) {
            // å¼•å½“å±¥æ­´ã«è¿½åŠ 
            const allocationBody = document.getElementById('allocationTableBody');
            const newRow = allocationBody.insertRow(0);
            const today = new Date().toISOString().split('T')[0];
            newRow.innerHTML = `
                <td>å—æ³¨-${orderId}</td>
                <td>${lotNumber}</td>
                <td>${materialName}</td>
                <td>${quantity}</td>
                <td>${today}</td>
            `;
            
            // åœ¨åº«ä¸€è¦§ã‚’æ›´æ–°
            const inventoryRows = document.querySelectorAll('#inventoryTableBody tr');
            inventoryRows.forEach(row => {
                const rowLotNumber = row.cells[0].textContent;
                if (rowLotNumber === lotNumber) {
                    const remainingCell = row.cells[4];
                    const currentRemaining = parseInt(remainingCell.textContent, 10) || 0;
                    remainingCell.textContent = currentRemaining - quantity;
                }
            });
            
            // çµ±è¨ˆæ›´æ–°
            const unallocated = parseInt(document.getElementById('unallocatedOrders').textContent, 10) || 0;
            document.getElementById('unallocatedOrders').textContent = unallocated - 1;
            
            const totalStock = parseInt(document.getElementById('totalStock').textContent, 10) || 0;
            document.getElementById('totalStock').textContent = totalStock - quantity;
            
            showToast(`âœ… å¼•å½“å®Œäº†: ${materialName} ${quantity}å€‹ â†’ ${lotNumber}`, 'success');
        }
        
        // ========================================
        // å‡ºè·ãƒ‡ãƒ¼ã‚¿ç®¡ç†æ©Ÿèƒ½
        // ========================================
        
        // å‡ºè·ãƒ‡ãƒ¼ã‚¿ã®JSONé…åˆ—
        let shippingData = [
            {
                lotNumber: "",
                customerPartNumber: "ABC-12345",
                makerPartNumber: "XYZ-98765",
                orderQuantity: 100,          // å—æ³¨æ•°é‡(å›ºå®š)
                orderQuantityUnit: "å€‹",      // å—æ³¨æ•°é‡å˜ä½(å›ºå®š)
                quantity: 100,               // å†…éƒ¨æ•°é‡(ç·¨é›†å¯)
                quantityUnit: "å€‹",           // å†…éƒ¨æ•°é‡å˜ä½(è¡¨ç¤ºã®ã¿)
                supplier: "ãƒ‡ãƒ³ã‚½ãƒ¼",
                warehouseCode: "W001",
                warehouseName: "åå¤å±‹å€‰åº«",
                nextAreaCode: "A01",
                deliveryCode: "D001",
                deliveryName: "ãƒˆãƒ¨ã‚¿è‡ªå‹•è»Š",
                shippingText: "ç£¯éƒ¨"
            },
            {
                lotNumber: "LOT-2025-001",
                customerPartNumber: "DEF-67890",
                makerPartNumber: "MNO-54321",
                orderQuantity: 500,          // å—æ³¨: 500å€‹
                orderQuantityUnit: "å€‹",
                quantity: 50,                // å†…éƒ¨: 50ç®±(å˜ä½æ›ç®—)
                quantityUnit: "ç®±",
                supplier: "ã‚¢ã‚¤ã‚·ãƒ³",
                warehouseCode: "W002",
                warehouseName: "è±Šç”°å€‰åº«",
                nextAreaCode: "A02",
                deliveryCode: "D002",
                deliveryName: "æ—¥ç”£è‡ªå‹•è»Š",
                shippingText: "LOT-2025-001/ç£¯éƒ¨"
            },
            {
                lotNumber: "LOT-2025-002",
                customerPartNumber: "GHI-11111",
                makerPartNumber: "PQR-22222",
                orderQuantity: 200,          // å—æ³¨: 200kg
                orderQuantityUnit: "kg",
                quantity: 200,               // å†…éƒ¨: 200kg(åŒã˜å˜ä½)
                quantityUnit: "kg",
                supplier: "è±Šç”°åˆæˆ",
                warehouseCode: "W001",
                warehouseName: "åå¤å±‹å€‰åº«",
                nextAreaCode: "A03",
                deliveryCode: "D003",
                deliveryName: "ãƒ›ãƒ³ãƒ€",
                shippingText: "LOT-2025-002/ç£¯éƒ¨"
            }
        ];
        
        // SAPç™»éŒ²ãƒ­ã‚°
        let sapLogs = [];
        
        // å‡ºè·ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æç”»
        function renderShippingDataTable() {
            const tbody = document.getElementById('shippingDataTableBody');
            tbody.innerHTML = '';
            
            shippingData.forEach((row, index) => {
                // å˜ä½ãŒç•°ãªã‚‹ã‹ãƒã‚§ãƒƒã‚¯
                const isDifferentUnit = row.orderQuantityUnit !== row.quantityUnit;
                const unitDiffClass = isDifferentUnit ? 'unit-difference' : '';
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="editable-cell" contenteditable="true" data-row="${index}" data-field="lotNumber">${row.lotNumber}</td>
                    <td>${row.customerPartNumber}</td>
                    <td>${row.makerPartNumber}</td>
                    <td class="two-tier-cell ${unitDiffClass}">
                        <div class="tier-top">
                            å—æ³¨: <strong>${row.orderQuantity}</strong> ${row.orderQuantityUnit}
                        </div>
                        <div class="tier-bottom">
                            å†…éƒ¨:
                            <span class="tier-bottom-editable" contenteditable="true" data-row="${index}" data-field="quantity">${row.quantity}</span>
                            <span class="tier-bottom-unit">${row.quantityUnit}</span>
                        </div>
                    </td>
                    <td>${row.supplier}</td>
                    <td>${row.warehouseCode}</td>
                    <td>${row.warehouseName}</td>
                    <td>${row.nextAreaCode}</td>
                    <td>${row.deliveryCode}</td>
                    <td>${row.deliveryName}</td>
                    <td class="editable-cell" contenteditable="true" data-row="${index}" data-field="shippingText">${row.shippingText}</td>
                `;
                tbody.appendChild(tr);
            });
            
            // ä»¶æ•°ã‚’æ›´æ–°
            document.getElementById('shippingDataCount').textContent = `(${shippingData.length}ä»¶)`;
            
            // ç·¨é›†å¯èƒ½ã‚»ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
            setupEditableCells();
        }
        
        // ç·¨é›†å¯èƒ½ã‚»ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        function setupEditableCells() {
            const editableCells = document.querySelectorAll('#shippingDataTable .editable-cell');
            const quantityCells = document.querySelectorAll('#shippingDataTable .tier-bottom-editable');
            
            // ãƒ­ãƒƒãƒˆç•ªå·ã®ç·¨é›†
            editableCells.forEach(cell => {
                if (cell.dataset.field === 'lotNumber') {
                    cell.addEventListener('blur', function() {
                        const rowIndex = parseInt(this.dataset.row);
                        const newLotNumber = this.textContent.trim();
                        
                        // ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
                        shippingData[rowIndex].lotNumber = newLotNumber;
                        
                        // å‡ºè·è¡¨ãƒ†ã‚­ã‚¹ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ
                        const newShippingText = newLotNumber ? `${newLotNumber}/ç£¯éƒ¨` : 'ç£¯éƒ¨';
                        shippingData[rowIndex].shippingText = newShippingText;
                        
                        // å‡ºè·è¡¨ãƒ†ã‚­ã‚¹ãƒˆã‚»ãƒ«ã‚’æ›´æ–°
                        const shippingTextCell = document.querySelector(
                            `#shippingDataTable .editable-cell[data-row="${rowIndex}"][data-field="shippingText"]`
                        );
                        if (shippingTextCell) {
                            shippingTextCell.textContent = newShippingText;
                        }
                        
                        showToast('ãƒ­ãƒƒãƒˆç•ªå·ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
                    });
                }
                
                // å‡ºè·è¡¨ãƒ†ã‚­ã‚¹ãƒˆã®ç›´æ¥ç·¨é›†
                if (cell.dataset.field === 'shippingText') {
                    cell.addEventListener('blur', function() {
                        const rowIndex = parseInt(this.dataset.row);
                        const newShippingText = this.textContent.trim();
                        
                        // ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
                        shippingData[rowIndex].shippingText = newShippingText;
                        
                        showToast('å‡ºè·è¡¨ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
                    });
                }
                
                // Enterã‚­ãƒ¼ã§æ¬¡ã®ã‚»ãƒ«ã«ç§»å‹•
                cell.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        this.blur();
                    }
                });
            });
            
            // å†…éƒ¨æ•°é‡ã®ç·¨é›†
            quantityCells.forEach(cell => {
                cell.addEventListener('blur', function() {
                    const rowIndex = parseInt(this.dataset.row);
                    const newQuantity = parseFloat(this.textContent.trim()) || 0;
                    
                    // ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
                    shippingData[rowIndex].quantity = newQuantity;
                    
                    // æ•°å€¤ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
                    this.textContent = newQuantity;
                    
                    showToast('å†…éƒ¨æ•°é‡ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
                });
                
                // æ•°å€¤å…¥åŠ›ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
                cell.addEventListener('keypress', function(e) {
                    // æ•°å­—ã€å°æ•°ç‚¹ã€ãƒãƒƒã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã€å‰Šé™¤ã®ã¿è¨±å¯
                    if (!/[\d.]/.test(e.key) && e.key !== 'Backspace' && e.key !== 'Delete') {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            this.blur();
                        } else {
                            e.preventDefault();
                        }
                    }
                });
            });
        }
        
        // æŠ˜ã‚ŠãŸãŸã¿æ©Ÿèƒ½
        function toggleCollapse(sectionId) {
            const content = document.getElementById(sectionId + 'Content');
            const toggle = document.getElementById(sectionId + 'Toggle');
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                toggle.classList.remove('collapsed');
            } else {
                content.classList.add('collapsed');
                toggle.classList.add('collapsed');
            }
        }
        
        // SAPç™»éŒ²æ©Ÿèƒ½
        function registerToSAP() {
            // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°
            const confirmed = confirm(`
ã€SAPç™»éŒ²ç¢ºèªã€‘

ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’SAPã«ç™»éŒ²ã—ã¾ã™:
ãƒ»ç™»éŒ²ä»¶æ•°: ${shippingData.length}ä»¶
ãƒ»å˜ä½æ›ç®—ã‚ã‚Š: ${shippingData.filter(d => d.orderQuantityUnit !== d.quantityUnit).length}ä»¶

ç™»éŒ²ã‚’å®Ÿè¡Œã—ã¾ã™ã‹?`);
            
            if (!confirmed) {
                return;
            }
            
            // é€ä¿¡å‡¦ç†ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
            const now = new Date();
            const timestamp = now.toLocaleString('ja-JP', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            // ãƒ­ã‚°ã«è¿½åŠ 
            const logEntry = {
                timestamp: timestamp,
                count: shippingData.length,
                status: 'success',
                note: 'æ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸ'
            };
            sapLogs.unshift(logEntry); // æœ€æ–°ã®ãƒ­ã‚°ã‚’å…ˆé ­ã«
            
            // ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ›´æ–°
            renderSapLogs();
            
            // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
            showToast(`âœ… SAPç™»éŒ²å®Œäº†: ${shippingData.length}ä»¶ã®ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã—ãŸ`, 'success');
        }
        
        // SAPç™»éŒ²ãƒ­ã‚°ã‚’æç”»
        function renderSapLogs() {
            const tbody = document.getElementById('sapLogTableBody');
            
            if (sapLogs.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; color: #999;">ã¾ã é€ä¿¡å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“</td></tr>';
                return;
            }
            
            tbody.innerHTML = '';
            sapLogs.forEach(log => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${log.timestamp}</td>
                    <td>${log.count}ä»¶</td>
                    <td><span class="badge badge-success">å®Œäº†</span></td>
                    <td>${log.note}</td>
                `;
                tbody.appendChild(tr);
            });
        }
        
        // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«å‡ºè·ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            renderShippingDataTable();
            renderSapLogs();
        });
    </script>
</body>
</html>